<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to the msSPChelpR package - from long dataset to SIR analyses • msSPChelpR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to the msSPChelpR package - from long dataset to SIR analyses">
<meta property="og:description" content="msSPChelpR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">msSPChelpR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.8.6.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/introduction.html">Introduction to the msSPChelpR package - from long dataset to SIR analyses</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/marianschmidt/msSPChelpR/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="introduction_files/accessible-code-block-0.0.1/empty-anchor.js"></script><link href="introduction_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="introduction_files/anchor-sections-1.0/anchor-sections.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to the msSPChelpR package - from long dataset to SIR analyses</h1>
                        <h4 class="author">Marian Eberl</h4>
            
            <h4 class="date">26 October 2020</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/marianschmidt/msSPChelpR/blob/master/vignettes/introduction.Rmd"><code>vignettes/introduction.Rmd</code></a></small>
      <div class="hidden name"><code>introduction.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>This vignette explains how to use the functions:</p>
<ul>
<li>
<code><a href="../reference/calc_futime.html">calc_futime()</a></code> to calculate follow-up time from index event until next event, death or end of follow-up date</li>
<li>
<code><a href="../reference/pat_status.html">pat_status()</a></code> to determine patient status at end of follow-up</li>
<li>
<code><a href="../reference/renumber_time_id.html">renumber_time_id()</a></code> to calculate a consecutive index of events per case ID</li>
<li>
<code><a href="../reference/reshape_long.html">reshape_long()</a></code> to transpose dataset in wide format to data in long format</li>
<li>
<code><a href="../reference/reshape_wide.html">reshape_wide()</a></code> to transpose dataset in long format to data in wide format (the wide format is required for many package functions)</li>
<li>
<code><a href="../reference/sir_byfutime.html">sir_byfutime()</a></code> to calculate standardized incidence ratios (SIRs) with custom grouping variables stratified by follow-up time</li>
<li>
<code><a href="../reference/summarize_sir_results.html">summarize_sir_results()</a></code> to summarize detailed SIR results produced by <code><a href="../reference/sir_byfutime.html">sir_byfutime()</a></code>
</li>
<li>
<code><a href="../reference/vital_status.html">vital_status()</a></code> to determine vital status whether patient is alive or dead at end of follow-up</li>
</ul>
<p>For some functions there are multiple variants of the same function using varying frameworks. They give the same results but will differ in execution time and memory use:</p>
<ul>
<li>
<a href="https://markfairbanks.github.io/tidytable/"><code>tidytable</code></a> variants carry the suffix <code>_tt()</code>
</li>
<li>
<a href="https://tidyr.tidyverse.org"><code>tidyr</code></a> variants carry the suffix <code>_tidyr()</code>
</li>
</ul>
</div>
<div id="recommended-workflows" class="section level1">
<h1 class="hasAnchor">
<a href="#recommended-workflows" class="anchor"></a>Recommended Workflows</h1>
<div id="wf-calc-fu" class="section level2">
<h2 class="hasAnchor">
<a href="#wf-calc-fu" class="anchor"></a>Calculate follow-up times</h2>
<p>It is recommended to run the following steps in the correct order to obtain accurate follow-up time calculations</p>
<ol style="list-style-type: decimal">
<li><p><a href="#step-long">Use the long version dataset</a></p></li>
<li><p><a href="#step-filter">Filter all cases</a> in the long version of the dataset that are relevant for your analysis. Make sure that:</p></li>
</ol>
<ul>
<li>for each <code>case_id</code> the index event (e.g. First Cancer FC) is still included and is the one remaining row in the dataset with the smallest <code>case_id</code> (<code>TUMID3</code> variable for ZfKD data, and <code>SEQ_NUM</code> for SEER data)</li>
<li>all <code>case_id</code>s might or might not get a countable incident event (e.g. Second Primary Cancer SPC). This event should be the second entry per <code>case_id</code> (second smallest <code>case_id</code>) if it is to be counted</li>
<li>in the long version dataset a <code>count_var</code> should indicate whether the countable incident event (SPC) has occurred or not. Coded <code>0</code> for non-occurrence (or not counted event) and <code>1</code> for a counted incident event.</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li><p><a href="#step-renumber">Renumber filtered long dataset</a>: In the filter long dataset, you should run the helper function <code>msSPChelpR::renumber_time_id_dt()</code> (or non-data.table variant <code><a href="../reference/renumber_time_id.html">msSPChelpR::renumber_time_id()</a></code>) that will renumber all events per <code>case_id</code> and (if step 1 is fulfilled) will assign each index event with <code>time_var_new = 1</code> and each second (possibly countable incident event) with <code>time_var_new = 2</code>. Any SIR related function will only count the second event, if additionally to <code>time_var_new = 2</code> for this row also <code>count_var = 1</code> is true.</p></li>
<li><p><a href="#step-reshape-wide">Reshape dataset</a>: Run <code>msSPChelpR::reshape_wide_dt()</code> or non-data.table-variant <code><a href="../reference/reshape_wide.html">msSPChelpR::reshape_wide()</a></code>, so that dataset is transposed to wide format (1 row per <code>case_id</code>, creating variables such as <code>count_var.2</code>).</p></li>
<li><p><a href="#step-spc">Set flag for Second Primary Cancer diagnosis</a>: After filtering and reshaping it is essential to set <code>p_spc</code> again. This variable will be used by later steps of the analysis.</p></li>
<li><p><a href="#step-pat-status">Determine patient status</a> at a defined end of follow-up by using the <code><a href="../reference/pat_status.html">msSPChelpR::pat_status()</a></code> function. This date for end of follow-up must:</p></li>
</ol>
<ul>
<li><p>be in “YYYY-MM-DD” format and is always defined via the <code>fu_end =</code> parameter</p></li>
<li><p>must precede the end of data collection. E.g. if the last incident events for the dataset you are using are collected at the end of 2014, your <code>fu_end</code> must be <code>fu_end = "2014-12-15"</code> or earlier.</p></li>
<li><p>Based on the newly calculated patient status, you might want to <a href="#step-filter-pat-status">exclude cases for which patient status cannot be determined</a></p></li>
</ul>
<ol start="7" style="list-style-type: decimal">
<li>
<a href="#step-calc-futime">Calculate follow-up time</a> for the same dataset by using the <code><a href="../reference/calc_futime.html">msSPChelpR::calc_futime()</a></code> function and the same <code>fu_end</code> as for step 6. By standard all functions of the <code>msSPChelpR</code> package require follow-up times as numeric years.</li>
</ol>
</div>
<div id="calculate-standardized-incidence-ratios-sir" class="section level2">
<h2 class="hasAnchor">
<a href="#calculate-standardized-incidence-ratios-sir" class="anchor"></a>Calculate Standardized Incidence Ratios (SIR)</h2>
<p>In order to calculate SIR using the package functions, the following data structure is needed: * Wide format data <code>wide_df</code> with one row per patient that has encountered the index event (i.e. diagnosed with a first primary cancer FC)</p>
<ul>
<li>The dataset <code>wide_df</code> needs to contain the following variables (columns) per patient (row):
<ul>
<li>
<code>region_var</code> - variable in df that contains information on region where case was incident.</li>
<li>
<code>agegroup_var</code> - variable in df that contains information on age-group.</li>
<li>
<code>sex_var</code> - variable in df that contains information on biological sex.</li>
<li>
<code>year_var</code> - variable in df that contains information on year or year-period when case was incident.</li>
<li>
<code>site_var</code> - variable in df that contains information on case (count event) diagnosis. Cases are usually the second cancers. Diagnoses can use any coding system (e.g. ICD) but coding system between dataset and reference data must be coherent.</li>
<li>
<code>futime_var</code> - variable in df that contains follow-up time per person between date of first cancer and any of death, date of event (case), end of FU date (in years; whatever event comes first). In case you have not calculated the FU time yet, you can use the workflow described in the previous <a href="#wf-calc-fu">chapter</a>.</li>
</ul>
</li>
</ul>
<p>If your data has the required structure, you can calculate and summarize SIRs with the following two steps:</p>
<ol start="8" style="list-style-type: decimal">
<li>
<a href="#step-sir-byfutime">Calculate SIR</a> per SPC diagnosis with age, sex, region, period-specific strata using the <code><a href="../reference/sir_byfutime.html">msSPChelpR::sir_byfutime()</a></code> function. For this calculation usually a reference dataset is required that defines the population standard rates. <code>refrates_df</code> must use the same category coding of age, sex, region, year and cancer_site as <code>agegroup_var</code>, <code>sex_var</code>, <code>region_var</code>, <code>year_var</code> and <code>site_var</code>
</li>
</ol>
<ul>
<li>The theory behind calculating stratified SIRs is explained in the chapter on <a href="#theo-sir">basics on SIRs</a>
</li>
</ul>
<ol start="9" style="list-style-type: decimal">
<li>
<a href="#step-summarize-sir">Summarize SIR results</a> using the <code><a href="../reference/summarize_sir_results.html">msSPChelpR::summarize_sir_results()</a></code> function on the stratified sir results produced by the previous step.</li>
</ol>
</div>
</div>
<div id="theo-sir" class="section level1">
<h1 class="hasAnchor">
<a href="#theo-sir" class="anchor"></a>Theory behind SIRs</h1>
<p>In the next version of this vignette the theoretical considerations how SIRs are calculated will be explained in this chapter.</p>
</div>
<div id="examples" class="section level1">
<h1 class="hasAnchor">
<a href="#examples" class="anchor"></a>Examples</h1>
<div id="seer-lung-cancer" class="section level2">
<h2 class="hasAnchor">
<a href="#seer-lung-cancer" class="anchor"></a>SEER lung cancer</h2>
<div id="step-long" class="section level3">
<h3 class="hasAnchor">
<a href="#step-long" class="anchor"></a>Step 1 - Long dataset</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'dplyr'</span>
<span class="co">#&gt; The following objects are masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     filter, lag</span>
<span class="co">#&gt; The following objects are masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     intersect, setdiff, setequal, union</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org">magrittr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://marianschmidt.github.io/msSPChelpR/">msSPChelpR</a></span><span class="op">)</span>
<span class="co">#Load synthetic dataset of patients with cancer to demonstrate package functions</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"us_second_cancer"</span><span class="op">)</span>

<span class="co">#This dataset is in long format, so each tumor is a separate row in the data</span>
<span class="va">us_second_cancer</span>
<span class="co">#&gt; # A tibble: 113,999 x 15</span>
<span class="co">#&gt;    fake_id SEQ_NUM registry sex   race  datebirth  t_datediag t_site_icd t_dco</span>
<span class="co">#&gt;    &lt;chr&gt;     &lt;int&gt; &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt; &lt;date&gt;     &lt;date&gt;     &lt;chr&gt;      &lt;chr&gt;</span>
<span class="co">#&gt;  1 100004        1 SEER Re… Male  White 1926-01-01 1992-07-15 C50        hist…</span>
<span class="co">#&gt;  2 100004        2 SEER Re… Male  White 1926-01-01 2004-01-15 C54        hist…</span>
<span class="co">#&gt;  3 100004        3 SEER Re… Male  White 1926-01-01 2006-06-15 C34        hist…</span>
<span class="co">#&gt;  4 100004        4 SEER Re… Male  White 1926-01-01 2018-06-15 C14        DCO …</span>
<span class="co">#&gt;  5 100034        1 SEER Re… Male  White 1979-01-01 2000-06-15 C50        hist…</span>
<span class="co">#&gt;  6 100037        1 SEER Re… Fema… White 1938-01-01 1996-01-15 C54        hist…</span>
<span class="co">#&gt;  7 100038        1 SEER Re… Male  White 1989-01-01 1991-04-15 C50        hist…</span>
<span class="co">#&gt;  8 100038        2 SEER Re… Male  White 1989-01-01 2000-03-15 C80        hist…</span>
<span class="co">#&gt;  9 100039        1 SEER Re… Fema… White 1946-01-01 2003-08-15 C50        hist…</span>
<span class="co">#&gt; 10 100039        2 SEER Re… Fema… White 1946-01-01 2011-04-15 C34        hist…</span>
<span class="co">#&gt; # … with 113,989 more rows, and 6 more variables: fc_age &lt;int&gt;,</span>
<span class="co">#&gt; #   datedeath &lt;date&gt;, p_alive &lt;chr&gt;, p_dodmin &lt;date&gt;, fc_agegroup &lt;chr&gt;,</span>
<span class="co">#&gt; #   t_yeardiag &lt;chr&gt;</span></code></pre></div>
</div>
<div id="step-filter" class="section level3">
<h3 class="hasAnchor">
<a href="#step-filter" class="anchor"></a>Step 2 - Filter long dataset</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#filter for lung cancer</span>
<span class="va">ids</span> <span class="op">&lt;-</span> <span class="va">us_second_cancer</span> <span class="op">%&gt;%</span>
  <span class="co">#detect ids with any lung cancer</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">t_site_icd</span> <span class="op">==</span> <span class="st">"C34"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">fake_id</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/unname.html">unname</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">filtered_usdata</span> <span class="op">&lt;-</span> <span class="va">us_second_cancer</span> <span class="op">%&gt;%</span>
  <span class="co">#filter according to above detected ids with any lung cancer diagnosis</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">fake_id</span> <span class="op">%in%</span> <span class="va">ids</span><span class="op">)</span> <span class="op">%&gt;%</span>
   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">fake_id</span><span class="op">)</span>

<span class="va">filtered_usdata</span>
<span class="co">#&gt; # A tibble: 62,661 x 15</span>
<span class="co">#&gt;    fake_id SEQ_NUM registry sex   race  datebirth  t_datediag t_site_icd t_dco</span>
<span class="co">#&gt;    &lt;chr&gt;     &lt;int&gt; &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt; &lt;date&gt;     &lt;date&gt;     &lt;chr&gt;      &lt;chr&gt;</span>
<span class="co">#&gt;  1 100004        1 SEER Re… Male  White 1926-01-01 1992-07-15 C50        hist…</span>
<span class="co">#&gt;  2 100004        2 SEER Re… Male  White 1926-01-01 2004-01-15 C54        hist…</span>
<span class="co">#&gt;  3 100004        3 SEER Re… Male  White 1926-01-01 2006-06-15 C34        hist…</span>
<span class="co">#&gt;  4 100004        4 SEER Re… Male  White 1926-01-01 2018-06-15 C14        DCO …</span>
<span class="co">#&gt;  5 100039        1 SEER Re… Fema… White 1946-01-01 2003-08-15 C50        hist…</span>
<span class="co">#&gt;  6 100039        2 SEER Re… Fema… White 1946-01-01 2011-04-15 C34        hist…</span>
<span class="co">#&gt;  7 100039        3 SEER Re… Fema… White 1946-01-01 2018-01-15 C80        hist…</span>
<span class="co">#&gt;  8 100073        1 SEER Re… Male  White 1960-01-01 1993-11-15 C44        hist…</span>
<span class="co">#&gt;  9 100073        2 SEER Re… Male  White 1960-01-01 2003-12-15 C34        hist…</span>
<span class="co">#&gt; 10 100143        1 SEER Re… Male  White 1944-01-01 1992-03-15 C50        hist…</span>
<span class="co">#&gt; # … with 62,651 more rows, and 6 more variables: fc_age &lt;int&gt;,</span>
<span class="co">#&gt; #   datedeath &lt;date&gt;, p_alive &lt;chr&gt;, p_dodmin &lt;date&gt;, fc_agegroup &lt;chr&gt;,</span>
<span class="co">#&gt; #   t_yeardiag &lt;chr&gt;</span></code></pre></div>
</div>
<div id="step-renumber" class="section level3">
<h3 class="hasAnchor">
<a href="#step-renumber" class="anchor"></a>Step 3 - Renumber <code>time_id</code>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">renumbered_usdata</span> <span class="op">&lt;-</span> <span class="va">filtered_usdata</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/renumber_time_id.html">renumber_time_id</a></span><span class="op">(</span>new_time_id_var <span class="op">=</span> <span class="st">"t_tumid"</span>, 
                   dattype <span class="op">=</span> <span class="st">"seer"</span>,
                   case_id_var <span class="op">=</span> <span class="st">"fake_id"</span><span class="op">)</span>

<span class="va">renumbered_usdata</span> <span class="op">%&gt;%</span>
   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">fake_id</span>, <span class="va">sex</span>, <span class="va">t_site_icd</span>, <span class="va">t_datediag</span>, <span class="va">t_tumid</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 62,661 x 5</span>
<span class="co">#&gt;    fake_id sex    t_site_icd t_datediag t_tumid</span>
<span class="co">#&gt;    &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;      &lt;date&gt;       &lt;int&gt;</span>
<span class="co">#&gt;  1 100004  Male   C50        1992-07-15       1</span>
<span class="co">#&gt;  2 100004  Male   C54        2004-01-15       2</span>
<span class="co">#&gt;  3 100004  Male   C34        2006-06-15       3</span>
<span class="co">#&gt;  4 100004  Male   C14        2018-06-15       4</span>
<span class="co">#&gt;  5 100039  Female C50        2003-08-15       1</span>
<span class="co">#&gt;  6 100039  Female C34        2011-04-15       2</span>
<span class="co">#&gt;  7 100039  Female C80        2018-01-15       3</span>
<span class="co">#&gt;  8 100073  Male   C44        1993-11-15       1</span>
<span class="co">#&gt;  9 100073  Male   C34        2003-12-15       2</span>
<span class="co">#&gt; 10 100143  Male   C50        1992-03-15       1</span>
<span class="co">#&gt; # … with 62,651 more rows</span></code></pre></div>
</div>
<div id="step-reshape-wide" class="section level3">
<h3 class="hasAnchor">
<a href="#step-reshape-wide" class="anchor"></a>Step 4 - Reshape to wide dataset</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">usdata_wide</span> <span class="op">&lt;-</span> <span class="va">renumbered_usdata</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/reshape_wide_tidyr.html">reshape_wide_tidyr</a></span><span class="op">(</span>case_id_var <span class="op">=</span> <span class="st">"fake_id"</span>, time_id_var <span class="op">=</span> <span class="st">"t_tumid"</span>, timevar_max <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>

<span class="co">#now the data is in the wide format as required by many package functions. </span>
<span class="co">#This means, each case is a row and several tumors per case ID are </span>
<span class="co">#add new columns to the data using the time_id as column name suffix.</span>
<span class="va">usdata_wide</span>
<span class="co">#&gt; # A tibble: 31,997 x 127</span>
<span class="co">#&gt;    fake_id SEQ_NUM.1 registry.1 sex.1 race.1 datebirth.1 t_datediag.1</span>
<span class="co">#&gt;    &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;      &lt;chr&gt; &lt;chr&gt;  &lt;date&gt;      &lt;date&gt;      </span>
<span class="co">#&gt;  1 100004          1 SEER Reg … Male  White  1926-01-01  1992-07-15  </span>
<span class="co">#&gt;  2 100039          1 SEER Reg … Fema… White  1946-01-01  2003-08-15  </span>
<span class="co">#&gt;  3 100073          1 SEER Reg … Male  White  1960-01-01  1993-11-15  </span>
<span class="co">#&gt;  4 100143          1 SEER Reg … Male  White  1944-01-01  1992-03-15  </span>
<span class="co">#&gt;  5 100182          1 SEER Reg … Male  Other  1927-01-01  1991-09-15  </span>
<span class="co">#&gt;  6 100197          1 SEER Reg … Fema… White  1945-01-01  2012-06-15  </span>
<span class="co">#&gt;  7 100208          1 SEER Reg … Male  White  1970-01-01  2019-11-15  </span>
<span class="co">#&gt;  8 100230          1 SEER Reg … Male  White  1947-01-01  1992-11-15  </span>
<span class="co">#&gt;  9 100234          1 SEER Reg … Male  White  1988-01-01  2010-02-15  </span>
<span class="co">#&gt; 10 100266          1 SEER Reg … Fema… White  1956-01-01  2010-07-15  </span>
<span class="co">#&gt; # … with 31,987 more rows, and 120 more variables: t_site_icd.1 &lt;chr&gt;,</span>
<span class="co">#&gt; #   t_dco.1 &lt;chr&gt;, fc_age.1 &lt;int&gt;, datedeath.1 &lt;date&gt;, p_alive.1 &lt;chr&gt;,</span>
<span class="co">#&gt; #   p_dodmin.1 &lt;date&gt;, fc_agegroup.1 &lt;chr&gt;, t_yeardiag.1 &lt;chr&gt;,</span>
<span class="co">#&gt; #   SEQ_NUM.2 &lt;int&gt;, registry.2 &lt;chr&gt;, sex.2 &lt;chr&gt;, race.2 &lt;chr&gt;,</span>
<span class="co">#&gt; #   datebirth.2 &lt;date&gt;, t_datediag.2 &lt;date&gt;, t_site_icd.2 &lt;chr&gt;, t_dco.2 &lt;chr&gt;,</span>
<span class="co">#&gt; #   fc_age.2 &lt;int&gt;, datedeath.2 &lt;date&gt;, p_alive.2 &lt;chr&gt;, p_dodmin.2 &lt;date&gt;,</span>
<span class="co">#&gt; #   fc_agegroup.2 &lt;chr&gt;, t_yeardiag.2 &lt;chr&gt;, SEQ_NUM.3 &lt;int&gt;, registry.3 &lt;chr&gt;,</span>
<span class="co">#&gt; #   sex.3 &lt;chr&gt;, race.3 &lt;chr&gt;, datebirth.3 &lt;date&gt;, t_datediag.3 &lt;date&gt;,</span>
<span class="co">#&gt; #   t_site_icd.3 &lt;chr&gt;, t_dco.3 &lt;chr&gt;, fc_age.3 &lt;int&gt;, datedeath.3 &lt;date&gt;,</span>
<span class="co">#&gt; #   p_alive.3 &lt;chr&gt;, p_dodmin.3 &lt;date&gt;, fc_agegroup.3 &lt;chr&gt;,</span>
<span class="co">#&gt; #   t_yeardiag.3 &lt;chr&gt;, SEQ_NUM.4 &lt;int&gt;, registry.4 &lt;chr&gt;, sex.4 &lt;chr&gt;,</span>
<span class="co">#&gt; #   race.4 &lt;chr&gt;, datebirth.4 &lt;date&gt;, t_datediag.4 &lt;date&gt;, t_site_icd.4 &lt;chr&gt;,</span>
<span class="co">#&gt; #   t_dco.4 &lt;chr&gt;, fc_age.4 &lt;int&gt;, datedeath.4 &lt;date&gt;, p_alive.4 &lt;chr&gt;,</span>
<span class="co">#&gt; #   p_dodmin.4 &lt;date&gt;, fc_agegroup.4 &lt;chr&gt;, t_yeardiag.4 &lt;chr&gt;,</span>
<span class="co">#&gt; #   SEQ_NUM.5 &lt;int&gt;, registry.5 &lt;chr&gt;, sex.5 &lt;chr&gt;, race.5 &lt;chr&gt;,</span>
<span class="co">#&gt; #   datebirth.5 &lt;date&gt;, t_datediag.5 &lt;date&gt;, t_site_icd.5 &lt;chr&gt;, t_dco.5 &lt;chr&gt;,</span>
<span class="co">#&gt; #   fc_age.5 &lt;int&gt;, datedeath.5 &lt;date&gt;, p_alive.5 &lt;chr&gt;, p_dodmin.5 &lt;date&gt;,</span>
<span class="co">#&gt; #   fc_agegroup.5 &lt;chr&gt;, t_yeardiag.5 &lt;chr&gt;, SEQ_NUM.6 &lt;int&gt;, registry.6 &lt;chr&gt;,</span>
<span class="co">#&gt; #   sex.6 &lt;chr&gt;, race.6 &lt;chr&gt;, datebirth.6 &lt;date&gt;, t_datediag.6 &lt;date&gt;,</span>
<span class="co">#&gt; #   t_site_icd.6 &lt;chr&gt;, t_dco.6 &lt;chr&gt;, fc_age.6 &lt;int&gt;, datedeath.6 &lt;date&gt;,</span>
<span class="co">#&gt; #   p_alive.6 &lt;chr&gt;, p_dodmin.6 &lt;date&gt;, fc_agegroup.6 &lt;chr&gt;,</span>
<span class="co">#&gt; #   t_yeardiag.6 &lt;chr&gt;, SEQ_NUM.7 &lt;int&gt;, registry.7 &lt;chr&gt;, sex.7 &lt;chr&gt;,</span>
<span class="co">#&gt; #   race.7 &lt;chr&gt;, datebirth.7 &lt;date&gt;, t_datediag.7 &lt;date&gt;, t_site_icd.7 &lt;chr&gt;,</span>
<span class="co">#&gt; #   t_dco.7 &lt;chr&gt;, fc_age.7 &lt;int&gt;, datedeath.7 &lt;date&gt;, p_alive.7 &lt;chr&gt;,</span>
<span class="co">#&gt; #   p_dodmin.7 &lt;date&gt;, fc_agegroup.7 &lt;chr&gt;, t_yeardiag.7 &lt;chr&gt;,</span>
<span class="co">#&gt; #   SEQ_NUM.8 &lt;int&gt;, registry.8 &lt;chr&gt;, sex.8 &lt;chr&gt;, race.8 &lt;chr&gt;,</span>
<span class="co">#&gt; #   datebirth.8 &lt;date&gt;, t_datediag.8 &lt;date&gt;, t_site_icd.8 &lt;chr&gt;, t_dco.8 &lt;chr&gt;,</span>
<span class="co">#&gt; #   …</span></code></pre></div>
</div>
<div id="step-spc" class="section level3">
<h3 class="hasAnchor">
<a href="#step-spc" class="anchor"></a>Step 5 - Recalculate <code>p_spc</code>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">usdata_wide</span> <span class="op">&lt;-</span> <span class="va">usdata_wide</span> <span class="op">%&gt;%</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>p_spc <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">t_site_icd.2</span><span class="op">)</span>   <span class="op">~</span> <span class="st">"No SPC"</span>,
                         <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">t_site_icd.2</span><span class="op">)</span>           <span class="op">~</span> <span class="st">"SPC developed"</span>,
                         <span class="cn">TRUE</span> <span class="op">~</span> <span class="cn">NA_character_</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="co">#create the same information as numeric variable count_spc</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>count_spc <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">t_site_icd.2</span><span class="op">)</span>   <span class="op">~</span> <span class="fl">1</span>,
                            <span class="cn">TRUE</span> <span class="op">~</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span>
<span class="va">usdata_wide</span> <span class="op">%&gt;%</span>
   <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">fake_id</span>, <span class="va">sex.1</span>, <span class="va">p_spc</span>, <span class="va">count_spc</span>, <span class="va">t_site_icd.1</span>, 
                 <span class="va">t_datediag.1</span>, <span class="va">t_site_icd.2</span>, <span class="va">t_datediag.2</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 31,997 x 8</span>
<span class="co">#&gt;    fake_id sex.1 p_spc count_spc t_site_icd.1 t_datediag.1 t_site_icd.2</span>
<span class="co">#&gt;    &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;     &lt;dbl&gt; &lt;chr&gt;        &lt;date&gt;       &lt;chr&gt;       </span>
<span class="co">#&gt;  1 100004  Male  SPC …         0 C50          1992-07-15   C54         </span>
<span class="co">#&gt;  2 100039  Fema… SPC …         0 C50          2003-08-15   C34         </span>
<span class="co">#&gt;  3 100073  Male  SPC …         0 C44          1993-11-15   C34         </span>
<span class="co">#&gt;  4 100143  Male  SPC …         0 C50          1992-03-15   C34         </span>
<span class="co">#&gt;  5 100182  Male  SPC …         0 C18          1991-09-15   C34         </span>
<span class="co">#&gt;  6 100197  Fema… SPC …         0 C34          2012-06-15   C50         </span>
<span class="co">#&gt;  7 100208  Male  No S…         1 C34          2019-11-15   &lt;NA&gt;        </span>
<span class="co">#&gt;  8 100230  Male  SPC …         0 C44          1992-11-15   C34         </span>
<span class="co">#&gt;  9 100234  Male  No S…         1 C34          2010-02-15   &lt;NA&gt;        </span>
<span class="co">#&gt; 10 100266  Fema… No S…         1 C34          2010-07-15   &lt;NA&gt;        </span>
<span class="co">#&gt; # … with 31,987 more rows, and 1 more variable: t_datediag.2 &lt;date&gt;</span></code></pre></div>
</div>
<div id="step-pat-status" class="section level3">
<h3 class="hasAnchor">
<a href="#step-pat-status" class="anchor"></a>Step 6 - Determine patient status at end of FU</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">usdata_wide</span> <span class="op">&lt;-</span> <span class="va">usdata_wide</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/pat_status.html">pat_status</a></span><span class="op">(</span><span class="va">.</span>, fu_end <span class="op">=</span> <span class="st">"2017-12-31"</span>, dattype <span class="op">=</span> <span class="st">"seer"</span>,
             status_var <span class="op">=</span> <span class="st">"p_status"</span>, life_var <span class="op">=</span> <span class="st">"p_alive.1"</span>,
             spc_var <span class="op">=</span> <span class="st">"p_spc"</span>, birthdat_var <span class="op">=</span> <span class="st">"datebirth.1"</span>,
             lifedat_var <span class="op">=</span> <span class="st">"datedeath.1"</span>, fcdat_var <span class="op">=</span> <span class="st">"t_datediag.1"</span>,
             spcdat_var <span class="op">=</span> <span class="st">"t_datediag.2"</span>, life_stat_alive <span class="op">=</span> <span class="st">"Alive"</span>,
             life_stat_dead <span class="op">=</span> <span class="st">"Dead"</span>, spc_stat_yes <span class="op">=</span> <span class="st">"SPC developed"</span>,
             spc_stat_no <span class="op">=</span> <span class="st">"No SPC"</span>, lifedat_fu_end <span class="op">=</span> <span class="st">"2019-12-31"</span>,
             use_lifedatmin <span class="op">=</span> <span class="cn">FALSE</span>, check <span class="op">=</span> <span class="cn">TRUE</span>, 
             as_labelled_factor <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 10 x 3</span>
<span class="co">#&gt;    p_alive.1 p_status                                                          n</span>
<span class="co">#&gt;    &lt;chr&gt;     &lt;fct&gt;                                                         &lt;int&gt;</span>
<span class="co">#&gt;  1 Alive     Patient alive after FC (with or without following SPC after …  5940</span>
<span class="co">#&gt;  2 Alive     Patient alive after SPC                                       11316</span>
<span class="co">#&gt;  3 Alive     NA - Patient not born before end of FU                            4</span>
<span class="co">#&gt;  4 Alive     NA - Patient did not develop cancer before end of FU            849</span>
<span class="co">#&gt;  5 Dead      Patient alive after FC (with or without following SPC after …   863</span>
<span class="co">#&gt;  6 Dead      Patient alive after SPC                                        1360</span>
<span class="co">#&gt;  7 Dead      Patient dead after FC                                          6208</span>
<span class="co">#&gt;  8 Dead      Patient dead after SPC                                         5325</span>
<span class="co">#&gt;  9 Dead      NA - Patient did not develop cancer before end of FU             68</span>
<span class="co">#&gt; 10 Dead      NA - Patient date of death is missing                            64</span>
<span class="co">#&gt; # A tibble: 7 x 2</span>
<span class="co">#&gt;   p_status                                                                   n</span>
<span class="co">#&gt;   &lt;fct&gt;                                                                  &lt;int&gt;</span>
<span class="co">#&gt; 1 Patient alive after FC (with or without following SPC after end of FU)  6803</span>
<span class="co">#&gt; 2 Patient alive after SPC                                                12676</span>
<span class="co">#&gt; 3 Patient dead after FC                                                   6208</span>
<span class="co">#&gt; 4 Patient dead after SPC                                                  5325</span>
<span class="co">#&gt; 5 NA - Patient not born before end of FU                                     4</span>
<span class="co">#&gt; 6 NA - Patient did not develop cancer before end of FU                     917</span>
<span class="co">#&gt; 7 NA - Patient date of death is missing                                     64</span>

<span class="va">usdata_wide</span> <span class="op">%&gt;%</span>
   <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">fake_id</span>, <span class="va">p_status</span>, <span class="va">p_alive.1</span>, <span class="va">datedeath.1</span>, <span class="va">t_site_icd.1</span>, <span class="va">t_datediag.1</span>, 
                 <span class="va">t_site_icd.2</span>, <span class="va">t_datediag.2</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 31,997 x 8</span>
<span class="co">#&gt;    fake_id p_status p_alive.1 datedeath.1 t_site_icd.1 t_datediag.1 t_site_icd.2</span>
<span class="co">#&gt;    &lt;chr&gt;   &lt;fct&gt;    &lt;chr&gt;     &lt;date&gt;      &lt;chr&gt;        &lt;date&gt;       &lt;chr&gt;       </span>
<span class="co">#&gt;  1 100004  Patient… Alive     NA          C50          1992-07-15   C54         </span>
<span class="co">#&gt;  2 100039  Patient… Alive     NA          C50          2003-08-15   C34         </span>
<span class="co">#&gt;  3 100073  Patient… Dead      2005-06-01  C44          1993-11-15   C34         </span>
<span class="co">#&gt;  4 100143  Patient… Alive     NA          C50          1992-03-15   C34         </span>
<span class="co">#&gt;  5 100182  Patient… Dead      2007-05-01  C18          1991-09-15   C34         </span>
<span class="co">#&gt;  6 100197  Patient… Alive     NA          C34          2012-06-15   C50         </span>
<span class="co">#&gt;  7 100208  NA - Pa… Alive     NA          C34          2019-11-15   &lt;NA&gt;        </span>
<span class="co">#&gt;  8 100230  Patient… Dead      2008-05-01  C44          1992-11-15   C34         </span>
<span class="co">#&gt;  9 100234  Patient… Dead      2015-07-01  C34          2010-02-15   &lt;NA&gt;        </span>
<span class="co">#&gt; 10 100266  Patient… Alive     NA          C34          2010-07-15   &lt;NA&gt;        </span>
<span class="co">#&gt; # … with 31,987 more rows, and 1 more variable: t_datediag.2 &lt;date&gt;</span>

<span class="co">#alternatively, you can impute the date of death using lifedatmin_var</span>
<span class="va">usdata_wide</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/pat_status.html">pat_status</a></span><span class="op">(</span><span class="va">.</span>, fu_end <span class="op">=</span> <span class="st">"2017-12-31"</span>, dattype <span class="op">=</span> <span class="st">"seer"</span>,
             status_var <span class="op">=</span> <span class="st">"p_status"</span>, life_var <span class="op">=</span> <span class="st">"p_alive.1"</span>,
             spc_var <span class="op">=</span> <span class="st">"p_spc"</span>, birthdat_var <span class="op">=</span> <span class="st">"datebirth.1"</span>,
             lifedat_var <span class="op">=</span> <span class="st">"datedeath.1"</span>, fcdat_var <span class="op">=</span> <span class="st">"t_datediag.1"</span>,
             spcdat_var <span class="op">=</span> <span class="st">"t_datediag.2"</span>, life_stat_alive <span class="op">=</span> <span class="st">"Alive"</span>,
             life_stat_dead <span class="op">=</span> <span class="st">"Dead"</span>, spc_stat_yes <span class="op">=</span> <span class="st">"SPC developed"</span>,
             spc_stat_no <span class="op">=</span> <span class="st">"No SPC"</span>, lifedat_fu_end <span class="op">=</span> <span class="st">"2019-12-31"</span>,
             use_lifedatmin <span class="op">=</span> <span class="cn">TRUE</span>, lifedatmin_var <span class="op">=</span> <span class="st">"p_dodmin.1"</span>, 
             check <span class="op">=</span> <span class="cn">TRUE</span>, as_labelled_factor <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 9 x 3</span>
<span class="co">#&gt;   p_alive.1 p_status                                                           n</span>
<span class="co">#&gt;   &lt;chr&gt;     &lt;fct&gt;                                                          &lt;int&gt;</span>
<span class="co">#&gt; 1 Alive     Patient alive after FC (with or without following SPC after e…  5940</span>
<span class="co">#&gt; 2 Alive     Patient alive after SPC                                        11316</span>
<span class="co">#&gt; 3 Alive     NA - Patient not born before end of FU                             4</span>
<span class="co">#&gt; 4 Alive     NA - Patient did not develop cancer before end of FU             849</span>
<span class="co">#&gt; 5 Dead      Patient alive after FC (with or without following SPC after e…   867</span>
<span class="co">#&gt; 6 Dead      Patient alive after SPC                                         1361</span>
<span class="co">#&gt; 7 Dead      Patient dead after FC                                           6230</span>
<span class="co">#&gt; 8 Dead      Patient dead after SPC                                          5362</span>
<span class="co">#&gt; 9 Dead      NA - Patient did not develop cancer before end of FU              68</span>
<span class="co">#&gt; # A tibble: 6 x 2</span>
<span class="co">#&gt;   p_status                                                                   n</span>
<span class="co">#&gt;   &lt;fct&gt;                                                                  &lt;int&gt;</span>
<span class="co">#&gt; 1 Patient alive after FC (with or without following SPC after end of FU)  6807</span>
<span class="co">#&gt; 2 Patient alive after SPC                                                12677</span>
<span class="co">#&gt; 3 Patient dead after FC                                                   6230</span>
<span class="co">#&gt; 4 Patient dead after SPC                                                  5362</span>
<span class="co">#&gt; 5 NA - Patient not born before end of FU                                     4</span>
<span class="co">#&gt; 6 NA - Patient did not develop cancer before end of FU                     917</span>
<span class="co">#&gt; # A tibble: 31,997 x 130</span>
<span class="co">#&gt;    fake_id SEQ_NUM.1 registry.1 sex.1 race.1 datebirth.1 t_datediag.1</span>
<span class="co">#&gt;    &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;      &lt;chr&gt; &lt;chr&gt;  &lt;date&gt;      &lt;date&gt;      </span>
<span class="co">#&gt;  1 100004          1 SEER Reg … Male  White  1926-01-01  1992-07-15  </span>
<span class="co">#&gt;  2 100039          1 SEER Reg … Fema… White  1946-01-01  2003-08-15  </span>
<span class="co">#&gt;  3 100073          1 SEER Reg … Male  White  1960-01-01  1993-11-15  </span>
<span class="co">#&gt;  4 100143          1 SEER Reg … Male  White  1944-01-01  1992-03-15  </span>
<span class="co">#&gt;  5 100182          1 SEER Reg … Male  Other  1927-01-01  1991-09-15  </span>
<span class="co">#&gt;  6 100197          1 SEER Reg … Fema… White  1945-01-01  2012-06-15  </span>
<span class="co">#&gt;  7 100208          1 SEER Reg … Male  White  1970-01-01  2019-11-15  </span>
<span class="co">#&gt;  8 100230          1 SEER Reg … Male  White  1947-01-01  1992-11-15  </span>
<span class="co">#&gt;  9 100234          1 SEER Reg … Male  White  1988-01-01  2010-02-15  </span>
<span class="co">#&gt; 10 100266          1 SEER Reg … Fema… White  1956-01-01  2010-07-15  </span>
<span class="co">#&gt; # … with 31,987 more rows, and 123 more variables: t_site_icd.1 &lt;chr&gt;,</span>
<span class="co">#&gt; #   t_dco.1 &lt;chr&gt;, fc_age.1 &lt;int&gt;, datedeath.1 &lt;date&gt;, p_alive.1 &lt;chr&gt;,</span>
<span class="co">#&gt; #   p_dodmin.1 &lt;date&gt;, fc_agegroup.1 &lt;chr&gt;, t_yeardiag.1 &lt;chr&gt;,</span>
<span class="co">#&gt; #   SEQ_NUM.2 &lt;int&gt;, registry.2 &lt;chr&gt;, sex.2 &lt;chr&gt;, race.2 &lt;chr&gt;,</span>
<span class="co">#&gt; #   datebirth.2 &lt;date&gt;, t_datediag.2 &lt;date&gt;, t_site_icd.2 &lt;chr&gt;, t_dco.2 &lt;chr&gt;,</span>
<span class="co">#&gt; #   fc_age.2 &lt;int&gt;, datedeath.2 &lt;date&gt;, p_alive.2 &lt;chr&gt;, p_dodmin.2 &lt;date&gt;,</span>
<span class="co">#&gt; #   fc_agegroup.2 &lt;chr&gt;, t_yeardiag.2 &lt;chr&gt;, SEQ_NUM.3 &lt;int&gt;, registry.3 &lt;chr&gt;,</span>
<span class="co">#&gt; #   sex.3 &lt;chr&gt;, race.3 &lt;chr&gt;, datebirth.3 &lt;date&gt;, t_datediag.3 &lt;date&gt;,</span>
<span class="co">#&gt; #   t_site_icd.3 &lt;chr&gt;, t_dco.3 &lt;chr&gt;, fc_age.3 &lt;int&gt;, datedeath.3 &lt;date&gt;,</span>
<span class="co">#&gt; #   p_alive.3 &lt;chr&gt;, p_dodmin.3 &lt;date&gt;, fc_agegroup.3 &lt;chr&gt;,</span>
<span class="co">#&gt; #   t_yeardiag.3 &lt;chr&gt;, SEQ_NUM.4 &lt;int&gt;, registry.4 &lt;chr&gt;, sex.4 &lt;chr&gt;,</span>
<span class="co">#&gt; #   race.4 &lt;chr&gt;, datebirth.4 &lt;date&gt;, t_datediag.4 &lt;date&gt;, t_site_icd.4 &lt;chr&gt;,</span>
<span class="co">#&gt; #   t_dco.4 &lt;chr&gt;, fc_age.4 &lt;int&gt;, datedeath.4 &lt;date&gt;, p_alive.4 &lt;chr&gt;,</span>
<span class="co">#&gt; #   p_dodmin.4 &lt;date&gt;, fc_agegroup.4 &lt;chr&gt;, t_yeardiag.4 &lt;chr&gt;,</span>
<span class="co">#&gt; #   SEQ_NUM.5 &lt;int&gt;, registry.5 &lt;chr&gt;, sex.5 &lt;chr&gt;, race.5 &lt;chr&gt;,</span>
<span class="co">#&gt; #   datebirth.5 &lt;date&gt;, t_datediag.5 &lt;date&gt;, t_site_icd.5 &lt;chr&gt;, t_dco.5 &lt;chr&gt;,</span>
<span class="co">#&gt; #   fc_age.5 &lt;int&gt;, datedeath.5 &lt;date&gt;, p_alive.5 &lt;chr&gt;, p_dodmin.5 &lt;date&gt;,</span>
<span class="co">#&gt; #   fc_agegroup.5 &lt;chr&gt;, t_yeardiag.5 &lt;chr&gt;, SEQ_NUM.6 &lt;int&gt;, registry.6 &lt;chr&gt;,</span>
<span class="co">#&gt; #   sex.6 &lt;chr&gt;, race.6 &lt;chr&gt;, datebirth.6 &lt;date&gt;, t_datediag.6 &lt;date&gt;,</span>
<span class="co">#&gt; #   t_site_icd.6 &lt;chr&gt;, t_dco.6 &lt;chr&gt;, fc_age.6 &lt;int&gt;, datedeath.6 &lt;date&gt;,</span>
<span class="co">#&gt; #   p_alive.6 &lt;chr&gt;, p_dodmin.6 &lt;date&gt;, fc_agegroup.6 &lt;chr&gt;,</span>
<span class="co">#&gt; #   t_yeardiag.6 &lt;chr&gt;, SEQ_NUM.7 &lt;int&gt;, registry.7 &lt;chr&gt;, sex.7 &lt;chr&gt;,</span>
<span class="co">#&gt; #   race.7 &lt;chr&gt;, datebirth.7 &lt;date&gt;, t_datediag.7 &lt;date&gt;, t_site_icd.7 &lt;chr&gt;,</span>
<span class="co">#&gt; #   t_dco.7 &lt;chr&gt;, fc_age.7 &lt;int&gt;, datedeath.7 &lt;date&gt;, p_alive.7 &lt;chr&gt;,</span>
<span class="co">#&gt; #   p_dodmin.7 &lt;date&gt;, fc_agegroup.7 &lt;chr&gt;, t_yeardiag.7 &lt;chr&gt;,</span>
<span class="co">#&gt; #   SEQ_NUM.8 &lt;int&gt;, registry.8 &lt;chr&gt;, sex.8 &lt;chr&gt;, race.8 &lt;chr&gt;,</span>
<span class="co">#&gt; #   datebirth.8 &lt;date&gt;, t_datediag.8 &lt;date&gt;, t_site_icd.8 &lt;chr&gt;, t_dco.8 &lt;chr&gt;,</span>
<span class="co">#&gt; #   …</span></code></pre></div>
<div id="step-filter-pat-status" class="section level4">
<h4 class="hasAnchor">
<a href="#step-filter-pat-status" class="anchor"></a>Step 6b - Remove patients irrelevant to analysis depending on status</h4>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">usdata_wide</span> <span class="op">&lt;-</span> <span class="va">usdata_wide</span> <span class="op">%&gt;%</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">p_status</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"NA - Patient not born before end of FU"</span>,
                                 <span class="st">"NA - Patient did not develop cancer before end of FU"</span>,
                                 <span class="st">"NA - Patient date of death is missing"</span><span class="op">)</span><span class="op">)</span>

<span class="va">usdata_wide</span> <span class="op">%&gt;%</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">p_status</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 4 x 2</span>
<span class="co">#&gt;   p_status                                                                   n</span>
<span class="co">#&gt;   &lt;fct&gt;                                                                  &lt;int&gt;</span>
<span class="co">#&gt; 1 Patient alive after FC (with or without following SPC after end of FU)  6803</span>
<span class="co">#&gt; 2 Patient alive after SPC                                                12676</span>
<span class="co">#&gt; 3 Patient dead after FC                                                   6208</span>
<span class="co">#&gt; 4 Patient dead after SPC                                                  5325</span></code></pre></div>
</div>
</div>
<div id="step-calc-futime" class="section level3">
<h3 class="hasAnchor">
<a href="#step-calc-futime" class="anchor"></a>Step 7 - Calculate FU time</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">usdata_wide</span> <span class="op">&lt;-</span> <span class="va">usdata_wide</span> <span class="op">%&gt;%</span>
   <span class="fu"><a href="../reference/calc_futime.html">calc_futime</a></span><span class="op">(</span><span class="va">.</span>, futime_var_new <span class="op">=</span> <span class="st">"p_futimeyrs"</span>, fu_end <span class="op">=</span> <span class="st">"2017-12-31"</span>,
               dattype <span class="op">=</span> <span class="st">"seer"</span>, time_unit <span class="op">=</span> <span class="st">"years"</span>, 
               lifedat_var <span class="op">=</span> <span class="st">"datedeath.1"</span>, 
               fcdat_var <span class="op">=</span> <span class="st">"t_datediag.1"</span>, spcdat_var <span class="op">=</span> <span class="st">"t_datediag.2"</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 4 x 5</span>
<span class="co">#&gt;   p_status                       mean_futime min_futime max_futime median_futime</span>
<span class="co">#&gt;   &lt;fct&gt;                                &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;         &lt;dbl&gt;</span>
<span class="co">#&gt; 1 Patient alive after FC (with …        9.58     0.0438       27.0          8.29</span>
<span class="co">#&gt; 2 Patient alive after SPC               8.69     0            26.9          7.50</span>
<span class="co">#&gt; 3 Patient dead after FC                 8.54     0            25.8          7.47</span>
<span class="co">#&gt; 4 Patient dead after SPC                6.33     0            26.5          5.08</span>

<span class="va">usdata_wide</span> <span class="op">%&gt;%</span>
   <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">fake_id</span>, <span class="va">p_status</span>, <span class="va">p_futimeyrs</span>, <span class="va">p_alive.1</span>, <span class="va">datedeath.1</span>, <span class="va">t_datediag.1</span>, <span class="va">t_datediag.2</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 31,012 x 7</span>
<span class="co">#&gt;    fake_id p_status  p_futimeyrs p_alive.1 datedeath.1 t_datediag.1 t_datediag.2</span>
<span class="co">#&gt;    &lt;chr&gt;   &lt;fct&gt;           &lt;dbl&gt; &lt;chr&gt;     &lt;date&gt;      &lt;date&gt;       &lt;date&gt;      </span>
<span class="co">#&gt;  1 100004  Patient …       11.5  Alive     NA          1992-07-15   2004-01-15  </span>
<span class="co">#&gt;  2 100039  Patient …        7.67 Alive     NA          2003-08-15   2011-04-15  </span>
<span class="co">#&gt;  3 100073  Patient …       10.1  Dead      2005-06-01  1993-11-15   2003-12-15  </span>
<span class="co">#&gt;  4 100143  Patient …        3.33 Alive     NA          1992-03-15   1995-07-15  </span>
<span class="co">#&gt;  5 100182  Patient …        7.08 Dead      2007-05-01  1991-09-15   1998-10-15  </span>
<span class="co">#&gt;  6 100197  Patient …        4.83 Alive     NA          2012-06-15   2017-04-15  </span>
<span class="co">#&gt;  7 100230  Patient …       11.0  Dead      2008-05-01  1992-11-15   2003-11-15  </span>
<span class="co">#&gt;  8 100234  Patient …        5.37 Dead      2015-07-01  2010-02-15   NA          </span>
<span class="co">#&gt;  9 100266  Patient …        7.46 Alive     NA          2010-07-15   NA          </span>
<span class="co">#&gt; 10 100274  Patient …        2.38 Dead      2006-06-01  2004-01-15   NA          </span>
<span class="co">#&gt; # … with 31,002 more rows</span></code></pre></div>
</div>
<div id="step-sir-byfutime" class="section level3">
<h3 class="hasAnchor">
<a href="#step-sir-byfutime" class="anchor"></a>Step 8 - Calculate SIR</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sircalc_results</span> <span class="op">&lt;-</span> <span class="va">usdata_wide</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/sir_byfutime.html">sir_byfutime</a></span><span class="op">(</span>
    dattype <span class="op">=</span> <span class="st">"seer"</span>,
    ybreak_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"race.1"</span>, <span class="st">"t_dco.1"</span><span class="op">)</span>,
    xbreak_var <span class="op">=</span> <span class="st">"none"</span>,
    futime_breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">12</span>, <span class="fl">2</span><span class="op">/</span><span class="fl">12</span>, <span class="fl">1</span>, <span class="fl">5</span>, <span class="fl">10</span>, <span class="cn">Inf</span><span class="op">)</span>,
    count_var <span class="op">=</span> <span class="st">"count_spc"</span>,
    refrates_df <span class="op">=</span> <span class="va">us_refrates_icd2</span>,
    calc_total_row <span class="op">=</span> <span class="cn">TRUE</span>,
    calc_total_fu <span class="op">=</span> <span class="cn">TRUE</span>,
    region_var <span class="op">=</span> <span class="st">"registry.1"</span>,
    age_var <span class="op">=</span> <span class="st">"fc_agegroup.1"</span>,
    sex_var <span class="op">=</span> <span class="st">"sex.1"</span>,
    year_var <span class="op">=</span> <span class="st">"t_yeardiag.1"</span>,
    site_var <span class="op">=</span> <span class="st">"t_site_icd.1"</span>, <span class="co">#using grouping by second cancer incidence</span>
    futime_var <span class="op">=</span> <span class="st">"p_futimeyrs"</span>,
    alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  [INFO Cases 0 PYARs] There are conflicts where strata with 0 follow-up time have data in observed. </span>
<span class="co">#&gt; # tidytable [4 × 10]</span>
<span class="co">#&gt;   age    sex    region     year  race.1 t_site to1month i_observed i_pyar n_base</span>
<span class="co">#&gt;   &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;      &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;     &lt;dbl&gt;      &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;</span>
<span class="co">#&gt; 1 05 - … Male   SEER Reg … 2015… Other  C34           1          1      0      1</span>
<span class="co">#&gt; 2 15 - … Male   SEER Reg … 2005… Black  C34           1          1      0      1</span>
<span class="co">#&gt; 3 85 - … Female SEER Reg … 1995… Black  C34           1          2      0      2</span>
<span class="co">#&gt; 4 85 - … Male   SEER Reg … 2010… Other  C34           1          1      0      1 </span>
<span class="co">#&gt; Check attribute `problems_not_empty` of results to see what strata are affected. </span>
<span class="co">#&gt; This might be caused by cases where SPC occured at the same day as first cancer. </span>
<span class="co">#&gt; You can check this by excluding all cases from wide_df, where date of first diagnosis is equal.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  [INFO Cases 0 PYARs] There are conflicts where strata with 0 follow-up time have data in observed. </span>
<span class="co">#&gt; # tidytable [4 × 10]</span>
<span class="co">#&gt;   age   sex   region year  race.1 t_site Total0toInfyears i_observed i_pyar</span>
<span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;             &lt;dbl&gt;      &lt;dbl&gt;  &lt;dbl&gt;</span>
<span class="co">#&gt; 1 05 -… Male  SEER … 2015… Other  C34                   1          1      0</span>
<span class="co">#&gt; 2 15 -… Male  SEER … 2005… Black  C34                   1          1      0</span>
<span class="co">#&gt; 3 85 -… Fema… SEER … 1995… Black  C34                   1          2      0</span>
<span class="co">#&gt; 4 85 -… Male  SEER … 2010… Other  C34                   1          1      0</span>
<span class="co">#&gt; # … with 1 more variable: n_base &lt;dbl&gt; </span>
<span class="co">#&gt; Check attribute `problems_not_empty` of results to see what strata are affected. </span>
<span class="co">#&gt; This might be caused by cases where SPC occured at the same day as first cancer. </span>
<span class="co">#&gt; You can check this by excluding all cases from wide_df, where date of first diagnosis is equal.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  [INFO Cases 0 PYARs] There are conflicts where strata with 0 follow-up time have data in observed. </span>
<span class="co">#&gt; # tidytable [1 × 10]</span>
<span class="co">#&gt;   age    sex   region     year  t_dco.1 t_site to1month i_observed i_pyar n_base</span>
<span class="co">#&gt;   &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;      &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;     &lt;dbl&gt;      &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;</span>
<span class="co">#&gt; 1 80 - … Male  SEER Reg … 2010… DCO ca… C34           1          1      0      1 </span>
<span class="co">#&gt; Check attribute `problems_not_empty` of results to see what strata are affected. </span>
<span class="co">#&gt; This might be caused by cases where SPC occured at the same day as first cancer. </span>
<span class="co">#&gt; You can check this by excluding all cases from wide_df, where date of first diagnosis is equal.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  [INFO Cases 0 PYARs] There are conflicts where strata with 0 follow-up time have data in observed. </span>
<span class="co">#&gt; # tidytable [1 × 10]</span>
<span class="co">#&gt;   age   sex   region year  t_dco.1 t_site Total0toInfyears i_observed i_pyar</span>
<span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;             &lt;dbl&gt;      &lt;dbl&gt;  &lt;dbl&gt;</span>
<span class="co">#&gt; 1 80 -… Male  SEER … 2010… DCO ca… C34                   1          1      0</span>
<span class="co">#&gt; # … with 1 more variable: n_base &lt;dbl&gt; </span>
<span class="co">#&gt; Check attribute `problems_not_empty` of results to see what strata are affected. </span>
<span class="co">#&gt; This might be caused by cases where SPC occured at the same day as first cancer. </span>
<span class="co">#&gt; You can check this by excluding all cases from wide_df, where date of first diagnosis is equal.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  There are observed cases in the results file that do not occur in the refrates_df. </span>
<span class="co">#&gt; A possible explanation can be: </span>
<span class="co">#&gt;  - DCO cases </span>
<span class="co">#&gt;  - diagnosis of second cancer occured in different time period than first cancer </span>
<span class="co">#&gt; The following strata are affected: </span>
<span class="co">#&gt; # tidytable [166 × 21]</span>
<span class="co">#&gt;    yvar_name yvar_label fu_time age   sex   region year  t_site i_observed</span>
<span class="co">#&gt;    &lt;chr&gt;     &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;       &lt;dbl&gt;</span>
<span class="co">#&gt;  1 total_var Overall    1-5 ye… 60 -… Male  SEER … 2010… C34            17</span>
<span class="co">#&gt;  2 total_var Overall    1-5 ye… 65 -… Male  SEER … 2015… C34            18</span>
<span class="co">#&gt;  3 total_var Overall    5-10 y… 60 -… Male  SEER … 2010… C34            20</span>
<span class="co">#&gt;  4 total_var Overall    5-10 y… 60 -… Male  SEER … 2010… C34            22</span>
<span class="co">#&gt;  5 total_var Overall    5-10 y… 70 -… Male  SEER … 2005… C34            12</span>
<span class="co">#&gt;  6 total_var Overall    5-10 y… 75 -… Fema… SEER … 2005… C34            13</span>
<span class="co">#&gt;  7 total_var Overall    10+ ye… 25 -… Fema… SEER … 1995… C34            14</span>
<span class="co">#&gt;  8 total_var Overall    10+ ye… 60 -… Fema… SEER … 1995… C34            18</span>
<span class="co">#&gt;  9 total_var Overall    10+ ye… 60 -… Fema… SEER … 1995… C34            16</span>
<span class="co">#&gt; 10 total_var Overall    10+ ye… 65 -… Male  SEER … 2000… C34            29</span>
<span class="co">#&gt; # … with 156 more rows, and 12 more variables: i_pyar &lt;dbl&gt;, n_base &lt;dbl&gt;,</span>
<span class="co">#&gt; #   race &lt;chr&gt;, incidence_cases &lt;int&gt;, population_pyar &lt;int&gt;,</span>
<span class="co">#&gt; #   incidence_crude_rate &lt;dbl&gt;, i_expected &lt;dbl&gt;, sir &lt;dbl&gt;, sir_lci &lt;dbl&gt;,</span>
<span class="co">#&gt; #   sir_uci &lt;dbl&gt;, fu_time_sort &lt;int&gt;, yvar_sort &lt;int&gt;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Check attribute `notes_refcases` of results to see what strata are affected.</span>

<span class="co"># sircalc_results %&gt;% print(n = 100) # uncomment after tidytable 0.5.6 release</span></code></pre></div>
</div>
<div id="step-summarize-sir" class="section level3">
<h3 class="hasAnchor">
<a href="#step-summarize-sir" class="anchor"></a>Step 9 - Summarize SIR results</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#The summarize function is versatile. Her for example the summary by</span>

<span class="va">sircalc_results</span> <span class="op">%&gt;%</span>
  <span class="co">#summarize results across region, age, year and t_site</span>
  <span class="fu"><a href="../reference/summarize_sir_results.html">summarize_sir_results</a></span><span class="op">(</span><span class="va">.</span>,
                        summarize_groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"region"</span>, <span class="st">"age"</span>, <span class="st">"year"</span>, <span class="st">"race"</span><span class="op">)</span>,
                        summarize_site <span class="op">=</span> <span class="cn">TRUE</span>,
                        output <span class="op">=</span> <span class="st">"long"</span>,  output_information <span class="op">=</span> <span class="st">"minimal"</span>,
                        add_total_row <span class="op">=</span> <span class="st">"only"</span>,  add_total_fu <span class="op">=</span> <span class="st">"no"</span>,
                        collapse_ci <span class="op">=</span> <span class="cn">FALSE</span>,  shorten_total_cols <span class="op">=</span> <span class="cn">TRUE</span>,
                        fubreak_var_name <span class="op">=</span> <span class="st">"fu_time"</span>, ybreak_var_name <span class="op">=</span> <span class="st">"yvar_name"</span>,
                        xbreak_var_name <span class="op">=</span> <span class="st">"none"</span>, site_var_name <span class="op">=</span> <span class="st">"t_site"</span>,
                        alpha <span class="op">=</span> <span class="fl">0.05</span>
                        <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">region</span>, <span class="op">-</span><span class="va">age</span>, <span class="op">-</span><span class="va">year</span>, <span class="op">-</span><span class="va">race</span>, <span class="op">-</span><span class="va">sex</span>, <span class="op">-</span><span class="va">yvar_name</span><span class="op">)</span>
<span class="co">#&gt; # tidytable [7 × 8]</span>
<span class="co">#&gt;   yvar_label fu_time       fu_time_sort t_site observed expected   sir sir_ci   </span>
<span class="co">#&gt;   &lt;chr&gt;      &lt;chr&gt;                &lt;int&gt; &lt;chr&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;    </span>
<span class="co">#&gt; 1 Overall    to 1 month               1 Total      2616     145. 18.1  17.41 - …</span>
<span class="co">#&gt; 2 Overall    0.0833-0.167…            2 Total       640     144.  4.46 4.12 - 4…</span>
<span class="co">#&gt; 3 Overall    0.167-1 years            3 Total      5792    1378.  4.2  4.09 - 4…</span>
<span class="co">#&gt; 4 Overall    1-5 years                4 Total     23984    5346.  4.49 4.43 - 4…</span>
<span class="co">#&gt; 5 Overall    5-10 years               5 Total     24712    4249.  5.82 5.74 - 5…</span>
<span class="co">#&gt; 6 Overall    10+ years                6 Total     33928    3503.  9.69 9.58 - 9…</span>
<span class="co">#&gt; 7 Overall    Total 0 to I…            7 Total     91672   14764.  6.21 6.17 - 6…</span></code></pre></div>
</div>
</div>
<div id="built-with" class="section level2">
<h2 class="hasAnchor">
<a href="#built-with" class="anchor"></a>Built with</h2>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; R version 4.0.3 (2020-10-10)</span>
<span class="co">#&gt; Platform: x86_64-apple-darwin17.0 (64-bit)</span>
<span class="co">#&gt; Running under: macOS Catalina 10.15.7</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Matrix products: default</span>
<span class="co">#&gt; BLAS:   /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRblas.dylib</span>
<span class="co">#&gt; LAPACK: /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRlapack.dylib</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; locale:</span>
<span class="co">#&gt; [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attached base packages:</span>
<span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; other attached packages:</span>
<span class="co">#&gt; [1] msSPChelpR_0.8.6.9000 magrittr_2.0.1        dplyr_1.0.2          </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; loaded via a namespace (and not attached):</span>
<span class="co">#&gt;  [1] Rcpp_1.0.5        compiler_4.0.3    pillar_1.4.7      prettyunits_1.1.1</span>
<span class="co">#&gt;  [5] progress_1.2.2    forcats_0.5.0     tools_4.0.3       digest_0.6.27    </span>
<span class="co">#&gt;  [9] lubridate_1.7.9.2 evaluate_0.14     memoise_1.1.0     lifecycle_0.2.0  </span>
<span class="co">#&gt; [13] tibble_3.0.4      pkgconfig_2.0.3   rlang_0.4.9       cli_2.2.0        </span>
<span class="co">#&gt; [17] yaml_2.2.1        haven_2.3.1       pkgdown_1.6.1     xfun_0.19        </span>
<span class="co">#&gt; [21] stringr_1.4.0     knitr_1.30        generics_0.1.0    desc_1.2.0       </span>
<span class="co">#&gt; [25] fs_1.5.0          vctrs_0.3.5       systemfonts_0.3.2 hms_0.5.3        </span>
<span class="co">#&gt; [29] sjlabelled_1.1.7  rprojroot_2.0.2   tidyselect_1.1.0  glue_1.4.2       </span>
<span class="co">#&gt; [33] data.table_1.13.2 R6_2.5.0          textshaping_0.2.1 fansi_0.4.1      </span>
<span class="co">#&gt; [37] rmarkdown_2.5     purrr_0.3.4       tidyr_1.1.2       ellipsis_0.3.1   </span>
<span class="co">#&gt; [41] htmltools_0.5.0   assertthat_0.2.1  insight_0.11.0    tidytable_0.5.6  </span>
<span class="co">#&gt; [45] ragg_0.4.0        utf8_1.1.4        stringi_1.5.3     crayon_1.3.4</span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Marian Eberl.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
