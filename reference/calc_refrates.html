<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Calculate age-, sex-, cohort-, region-specific incidence rates from a cohort — calc_refrates • msSPChelpR</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate age-, sex-, cohort-, region-specific incidence rates from a cohort — calc_refrates"><meta property="og:description" content="Calculate age-, sex-, cohort-, region-specific incidence rates from a cohort"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">msSPChelpR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.9.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/introduction.html">Introduction to the msSPChelpR package - from long dataset to SIR analyses</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/marianschmidt/msSPChelpR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate age-, sex-, cohort-, region-specific incidence rates from a cohort</h1>
    <small class="dont-index">Source: <a href="https://github.com/marianschmidt/msSPChelpR/blob/HEAD/R/calc_refrates.R" class="external-link"><code>R/calc_refrates.R</code></a></small>
    <div class="hidden name"><code>calc_refrates.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calculate age-, sex-, cohort-, region-specific incidence rates from a cohort</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">calc_refrates</span><span class="op">(</span></span>
<span>  <span class="va">df</span>,</span>
<span>  dattype <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">count_var</span>,</span>
<span>  <span class="va">refpop_df</span>,</span>
<span>  calc_totals <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  fill_sites <span class="op">=</span> <span class="st">"no"</span>,</span>
<span>  region_var <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  age_var <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sex_var <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  year_var <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  race_var <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  site_var <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>df</dt>
<dd><p>dataframe in long format</p></dd>


<dt>dattype</dt>
<dd><p>can be "zfkd" or "seer" or NULL. Will set default variable names if dattype is "seer" or "zfkd". Default is NULL.</p></dd>


<dt>count_var</dt>
<dd><p>variable to be counted as observed case. Should be 1 for case to be counted.</p></dd>


<dt>refpop_df</dt>
<dd><p>df where reference population data is defined. Only required if option futime = "refpop" is chosen. It is assumed that refpop_df has the columns
"region" for region, "sex" for biological sex, "age" for age-groups (can be single ages or 5-year brackets), "year" for time period (can be single year or 5-year brackets),
"population_pyar" for person-years at risk in the respective age/sex/year cohort.
refpop_df must use the same category coding of age, sex, region, year and site as age_var, sex_var, region_var, year_var and site_var.</p></dd>


<dt>calc_totals</dt>
<dd><p>option to calculate totals for all age-groups, all sexes, all years, all races, all sites. Default is FALSE.</p></dd>


<dt>fill_sites</dt>
<dd><p>option to fill missing sites in observed with incidence rate of 0. Needs to define the coding system used.
Can be either "no" for not filling missing sites. "icd2d" for ICD-O-3 2 digit (C00-C80), "icd3d" for ICD-O-3 3digit,
"icd10gm2d" for ICD-10-GM 2-digit (C00-C97), "sitewho" for Site SEER WHO coding (no 1-89 categories), "sitewho_b"  for Site SEER WHO B recoding (no. 1-111 categories),
"sitewho_epi" for SITE SEER WHO coding with additional sums,  "sitewhogen" for SITE WHO coding with less categories to make compatible for international rates,
"sitewho_num" for numeric coding of Site SEER WHO coding (no 1-89 categories), "sitewho_b_num"  for numeric coding of Site SEER WHO B recoding (no. 1-111 categories),
"sitewhogen_num" for numeric international rates, c("manual", char_vector) of sites manually defined</p></dd>


<dt>region_var</dt>
<dd><p>variable in df that contains information on region where case was incident. Default is set if dattype is given.</p></dd>


<dt>age_var</dt>
<dd><p>variable in df that contains information on age-group. Default is set if dattype is given.</p></dd>


<dt>sex_var</dt>
<dd><p>variable in df that contains information on sex. Default is set if dattype is given.</p></dd>


<dt>year_var</dt>
<dd><p>variable in df that contains information on year or year-period when case was incident. Default is set if dattype is given.</p></dd>


<dt>race_var</dt>
<dd><p>optional argument, if rates should be calculated stratified by race. If you want to use this option, provide variable name of df that contains race information. If race_var is provided refpop_df needs to contain the variable "race".</p></dd>


<dt>site_var</dt>
<dd><p>variable in df that contains information on ICD code of case diagnosis. Cases are usually the second cancers. Default is set if dattype is given.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>df</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">#load sample data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"us_second_cancer"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"population_us"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">us_second_cancer</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="co">#create variable to indicate to be counted as case</span></span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>is_case <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="co">#calculate refrates - warning: these are not realistic numbers, just showing functionality</span></span></span>
<span class="r-in"><span>  <span class="fu">calc_refrates</span><span class="op">(</span>dattype <span class="op">=</span> <span class="st">"seer"</span>, , count_var <span class="op">=</span> <span class="st">"is_case"</span>, refpop_df <span class="op">=</span> <span class="va">population_us</span>,</span></span>
<span class="r-in"><span>               region_var <span class="op">=</span> <span class="st">"registry"</span>, age_var <span class="op">=</span> <span class="st">"fc_agegroup"</span>, sex_var <span class="op">=</span> <span class="st">"sex"</span>, </span></span>
<span class="r-in"><span>               site_var <span class="op">=</span> <span class="st">"t_site_icd"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [INFO Reference Population Missing] For some strata no population can be found.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;">ℹ</span> 144 strata have no reference population in `refpop_df`</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  - Solution could be to add these strata to `refpop_df`.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">!</span> Check attribute `problems_missing_refpop_strata` of results to see what strata are affected.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tidytable: 6,181 × 9</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    t_site region               year  sex   age   incid…¹ incid…² popul…³ popul…⁴</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> C14    SEER Reg 01 - San F… 1990… Fema… 00 -…       1   0.145  <span style="text-decoration: underline;">687</span>542 <span style="text-decoration: underline;">137</span>508.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> C14    SEER Reg 01 - San F… 1990… Fema… 25 -…       1   0.118  <span style="text-decoration: underline;">845</span>090 <span style="text-decoration: underline;">169</span>018 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> C14    SEER Reg 01 - San F… 1990… Fema… 35 -…       2   0.231  <span style="text-decoration: underline;">864</span>741 <span style="text-decoration: underline;">172</span>948.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> C14    SEER Reg 01 - San F… 1990… Fema… 45 -…       3   0.486  <span style="text-decoration: underline;">616</span>774 <span style="text-decoration: underline;">123</span>355.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> C14    SEER Reg 01 - San F… 1990… Fema… 50 -…       1   0.208  <span style="text-decoration: underline;">480</span>901  <span style="text-decoration: underline;">96</span>180.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> C14    SEER Reg 01 - San F… 1990… Fema… 60 -…       2   0.518  <span style="text-decoration: underline;">385</span>787  <span style="text-decoration: underline;">77</span>157.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> C14    SEER Reg 01 - San F… 1990… Fema… 70 -…       1   0.303  <span style="text-decoration: underline;">329</span>891  <span style="text-decoration: underline;">65</span>978.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> C14    SEER Reg 01 - San F… 1990… Fema… 75 -…       1   0.381  <span style="text-decoration: underline;">262</span>494  <span style="text-decoration: underline;">52</span>499.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> C14    SEER Reg 01 - San F… 1990… Male  00 -…       1   0.138  <span style="text-decoration: underline;">723</span>699 <span style="text-decoration: underline;">144</span>740.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> C14    SEER Reg 01 - San F… 1990… Male  25 -…       1   0.113  <span style="text-decoration: underline;">881</span>328 <span style="text-decoration: underline;">176</span>266.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># … with 6,171 more rows, and abbreviated variable names ¹​incidence_cases,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   ²​incidence_crude_rate, ³​population_pyar, ⁴​population_n_per_year</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ Use `print(n = ...)` to see more rows</span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="https://github.com/marianschmidt" class="external-link">Marian Eberl</a>.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

