<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Calculate age-, sex-, cohort-, region-specific incidence rates from a cohort — calc_refrates • msSPChelpR</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate age-, sex-, cohort-, region-specific incidence rates from a cohort — calc_refrates"><meta property="og:description" content="Calculate age-, sex-, cohort-, region-specific incidence rates from a cohort"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">msSPChelpR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.8.7.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/introduction.html">Introduction to the msSPChelpR package - from long dataset to SIR analyses</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/marianschmidt/msSPChelpR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate age-, sex-, cohort-, region-specific incidence rates from a cohort</h1>
    <small class="dont-index">Source: <a href="https://github.com/marianschmidt/msSPChelpR/blob/HEAD/R/calc_refrates.R" class="external-link"><code>R/calc_refrates.R</code></a></small>
    <div class="hidden name"><code>calc_refrates.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calculate age-, sex-, cohort-, region-specific incidence rates from a cohort</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">calc_refrates</span><span class="op">(</span>
  <span class="va">df</span>,
  dattype <span class="op">=</span> <span class="st">"zfkd"</span>,
  <span class="va">count_var</span>,
  <span class="va">refpop_df</span>,
  calc_totals <span class="op">=</span> <span class="cn">TRUE</span>,
  fill_sites <span class="op">=</span> <span class="st">"no"</span>,
  region_var <span class="op">=</span> <span class="cn">NULL</span>,
  age_var <span class="op">=</span> <span class="cn">NULL</span>,
  sex_var <span class="op">=</span> <span class="cn">NULL</span>,
  year_var <span class="op">=</span> <span class="cn">NULL</span>,
  race_var <span class="op">=</span> <span class="cn">NULL</span>,
  site_var <span class="op">=</span> <span class="cn">NULL</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>df</dt>
<dd><p>dataframe in long format</p></dd>
<dt>dattype</dt>
<dd><p>can be "zfkd" or "seer" or empty. Will set default variable names from dataset.</p></dd>
<dt>count_var</dt>
<dd><p>variable to be counted as observed case. Should be 1 for case to be counted.</p></dd>
<dt>refpop_df</dt>
<dd><p>df where reference population data is defined. Only required if option futime = "refpop" is chosen. It is assumed that refpop_df has the columns
"region" for region, "sex" for biological sex, "age" for age-groups (can be single ages or 5-year brackets), "year" for time period (can be single year or 5-year brackets),
"population_pyar" for person-years at risk in the respective age/sex/year cohort.
refpop_df must use the same category coding of age, sex, region, year and site as age_var, sex_var, region_var, year_var and site_var.</p></dd>
<dt>calc_totals</dt>
<dd><p>option to calculate totals for all age-groups, all sexes, all years, all races</p></dd>
<dt>fill_sites</dt>
<dd><p>option to fill missing sites in observed with incidence rate of 0. Needs to define the coding system used.
Can be either "no" for not filling missing sites. "icd2d" for ICD-10 2 digit, "icd3d" for ICD-10 3digit, "sitewho" for Site WHO</p></dd>
<dt>region_var</dt>
<dd><p>variable in df that contains information on region where case was incident. Default is set if dattype is given.</p></dd>
<dt>age_var</dt>
<dd><p>variable in df that contains information on age-group. Default is set if dattype is given.</p></dd>
<dt>sex_var</dt>
<dd><p>variable in df that contains information on sex. Default is set if dattype is given.</p></dd>
<dt>year_var</dt>
<dd><p>variable in df that contains information on year or year-period when case was incident. Default is set if dattype is given.</p></dd>
<dt>race_var</dt>
<dd><p>optional argument for dattype="seer", if rates should be calculated by race. If you want to use this option, provide variable name of df that contains race information.</p></dd>
<dt>site_var</dt>
<dd><p>variable in df that contains information on ICD code of case diagnosis. Cases are usually the second cancers. Default is set if dattype is given.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>df</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co">#load sample data</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"us_second_cancer"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"population_us"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">us_second_cancer</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span>
<span class="r-in">  <span class="co">#create variable to indicate to be counted as case</span></span>
<span class="r-in">  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>is_case <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span>
<span class="r-in">  <span class="co">#calculate refrates - warning: these are not realistic numbers, just showing functionality</span></span>
<span class="r-in">  <span class="fu">calc_refrates</span><span class="op">(</span>dattype <span class="op">=</span> <span class="st">"seer"</span>, , count_var <span class="op">=</span> <span class="st">"is_case"</span>, refpop_df <span class="op">=</span> <span class="va">population_us</span>,</span>
<span class="r-in">               region_var <span class="op">=</span> <span class="st">"registry"</span>, age_var <span class="op">=</span> <span class="st">"fc_agegroup"</span>, sex_var <span class="op">=</span> <span class="st">"sex"</span>, </span>
<span class="r-in">               site_var <span class="op">=</span> <span class="st">"t_site_icd"</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  [INFO Ref population missing]For the following age groups, sex, regions, years, t_sites no population can be found: </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tidytable: 144 × 4</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    age     sex    region                                   year       </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> 65 - 69 Male   SEER Reg 20 - Detroit (Metropolitan)     2015 - 2019</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> 55 - 59 Female SEER Reg 02 - Connecticut                2015 - 2019</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> 65 - 69 Female SEER Reg 20 - Detroit (Metropolitan)     2015 - 2019</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> 50 - 54 Male   SEER Reg 21 - Hawaii                     2015 - 2019</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> 45 - 49 Male   SEER Reg 02 - Connecticut                2015 - 2019</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> 50 - 54 Male   SEER Reg 01 - San Francisco-Oakland SMSA 2015 - 2019</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> 65 - 69 Male   SEER Reg 21 - Hawaii                     2015 - 2019</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> 75 - 79 Female SEER Reg 01 - San Francisco-Oakland SMSA 2015 - 2019</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> 65 - 69 Female SEER Reg 02 - Connecticut                2015 - 2019</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> 35 - 39 Male   SEER Reg 01 - San Francisco-Oakland SMSA 2015 - 2019</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># … with 134 more rows</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Check attribute `problems_missing_ref_strata` of results to see what strata are affected. </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Solution could be to add these strata to refpop_df. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tidytable: 6,181 × 9</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    t_site region           year    sex   age   incidence_cases incidence_crude_…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> C14    SEER Reg 01 - S… 1990 -… Fema… 00 -…               1             0.145</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> C14    SEER Reg 01 - S… 1990 -… Fema… 25 -…               1             0.118</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> C14    SEER Reg 01 - S… 1990 -… Fema… 35 -…               2             0.231</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> C14    SEER Reg 01 - S… 1990 -… Fema… 45 -…               3             0.486</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> C14    SEER Reg 01 - S… 1990 -… Fema… 50 -…               1             0.208</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> C14    SEER Reg 01 - S… 1990 -… Fema… 60 -…               2             0.518</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> C14    SEER Reg 01 - S… 1990 -… Fema… 70 -…               1             0.303</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> C14    SEER Reg 01 - S… 1990 -… Fema… 75 -…               1             0.381</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> C14    SEER Reg 01 - S… 1990 -… Male  00 -…               1             0.138</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> C14    SEER Reg 01 - S… 1990 -… Male  25 -…               1             0.113</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># … with 6,171 more rows, and 2 more variables: population_pyar &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   population_n_per_year &lt;dbl&gt;</span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="https://github.com/marianschmidt" class="external-link">Marian Eberl</a>.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer></div>

  


  

  </body></html>

